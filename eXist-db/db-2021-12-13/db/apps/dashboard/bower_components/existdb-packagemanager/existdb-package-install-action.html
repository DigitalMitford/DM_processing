<html><head></head><body><dom-module id="existdb-package-install-action"><template><style>:host{display:block;--paper-icon-button:{color:var(--paper-blue-700);};}</style><iron-ajax id="installPackage" verbose="" with-credentials="" method="post" handle-as="text" on-response="_handleResponse" url="../packageservice/packages/action" on-error="_handleError"></iron-ajax><paper-icon-button id="install" class="install" icon="file-download" title="download and install latest version" on-click="submit"></paper-icon-button><form id="installform" is="iron-form" method="post" action=""><input type="hidden" name="package-url" value="{{url}}"> <input type="hidden" name="abbrev" value="{{abbrev}}"> <input type="hidden" name="version" value="{{version}}"> <input type="hidden" name="action" value="install"> <input type="hidden" name="type" value="{{type}}"></form></template><script>class ExistdbPackageInstallAction extends Polymer.Element{static get is(){return"existdb-package-install-action"}static get properties(){return{url:{type:String,reflectToAttribute:!0},abbrev:{type:String,reflectToAttribute:!0},action:{type:String,reflectToAttribute:!0},version:{type:String,reflectToAttribute:!0},type:{type:String,reflectToAttribute:!0}}}constructor(){super()}connectedCallback(){super.connectedCallback();this.addEventListener("iron-form-response",()=>this.handleResponse);this.addEventListener("iron-form-error",()=>this.handleError)}submit(e){e.stopPropagation();e.preventDefault();this.dispatchEvent(new CustomEvent("package-install-started",{bubbles:!0,composed:!0,detail:{}}))}install(){this.$.installPackage.params={"package-url":this.url,action:"install",abbrev:this.abbrev,version:this.version};this.$.installPackage.generateRequest()}_handleResponse(){var error=JSON.parse(this.$.installPackage.lastResponse).error;if(error!=void 0){this.dispatchEvent(new CustomEvent("package-install-error",{bubbles:!0,composed:!0,detail:{error:error}}))}else{this.dispatchEvent(new CustomEvent("package-installed",{bubbles:!0,composed:!0,detail:{abbrev:this.abbrev}}))}}_handleError(e){this.dispatchEvent(new CustomEvent("package-install-error",{bubbles:!0,composed:!0,detail:{error:e.detail}}))}}window.customElements.define(ExistdbPackageInstallAction.is,ExistdbPackageInstallAction);</script></dom-module></body></html>