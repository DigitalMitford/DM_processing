(()=>{(function(n){n.fn.drag=function(s,o,l){var f=typeof s=="string"?s:"",d=n.isFunction(s)?s:n.isFunction(o)?o:null;return f.indexOf("drag")!==0&&(f="drag"+f),l=(s==d?o:l)||{},d?this.bind(f,l,d):this.trigger(f)};var i=n.event,e=i.special,t=e.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(s){var o=n.data(this,t.datakey),l=s.data||{};o.related+=1,n.each(t.defaults,function(f,d){l[f]!==void 0&&(o[f]=l[f])})},remove:function(){n.data(this,t.datakey).related-=1},setup:function(){if(!n.data(this,t.datakey)){var s=n.extend({related:0},t.defaults);n.data(this,t.datakey,s),i.add(this,"touchstart mousedown",t.init,s),this.attachEvent&&this.attachEvent("ondragstart",t.dontstart)}},teardown:function(){var s=n.data(this,t.datakey)||{};s.related||(n.removeData(this,t.datakey),i.remove(this,"touchstart mousedown",t.init),t.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",t.dontstart))},init:function(s){if(!t.touched){var o=s.data,l;if(!(s.which!=0&&o.which>0&&s.which!=o.which)&&!n(s.target).is(o.not)&&!(o.handle&&!n(s.target).closest(o.handle,s.currentTarget).length)&&(t.touched=s.type=="touchstart"?this:null,o.propagates=1,o.mousedown=this,o.interactions=[t.interaction(this,o)],o.target=s.target,o.pageX=s.pageX,o.pageY=s.pageY,o.dragging=null,l=t.hijack(s,"draginit",o),!!o.propagates&&(l=t.flatten(l),l&&l.length&&(o.interactions=[],n.each(l,function(){o.interactions.push(t.interaction(this,o))})),o.propagates=o.interactions.length,o.drop!==!1&&e.drop&&e.drop.handler(s,o),t.textselect(!1),t.touched?i.add(t.touched,"touchmove touchend",t.handler,o):i.add(document,"mousemove mouseup",t.handler,o),!t.touched||o.live)))return!1}},interaction:function(s,o){var l=n(s)[o.relative?"position":"offset"]()||{top:0,left:0};return{drag:s,callback:new t.callback,droppable:[],offset:l}},handler:function(s){var o=s.data;switch(s.type){case(!o.dragging&&"touchmove"):s.preventDefault();case(!o.dragging&&"mousemove"):if(Math.pow(s.pageX-o.pageX,2)+Math.pow(s.pageY-o.pageY,2)<Math.pow(o.distance,2))break;s.target=o.target,t.hijack(s,"dragstart",o),o.propagates&&(o.dragging=!0);case"touchmove":s.preventDefault();case"mousemove":if(o.dragging){if(t.hijack(s,"drag",o),o.propagates){o.drop!==!1&&e.drop&&e.drop.handler(s,o);break}s.type="mouseup"}case"touchend":case"mouseup":default:t.touched?i.remove(t.touched,"touchmove touchend",t.handler):i.remove(document,"mousemove mouseup",t.handler),o.dragging&&(o.drop!==!1&&e.drop&&e.drop.handler(s,o),t.hijack(s,"dragend",o)),t.textselect(!0),o.click===!1&&o.dragging&&n.data(o.mousedown,"suppress.click",new Date().getTime()+5),o.dragging=t.touched=!1;break}},hijack:function(s,o,l,f,d){if(!!l){var g={event:s.originalEvent,type:s.type},h=o.indexOf("drop")?"drag":"drop",u,m=f||0,p,c,_,y=isNaN(f)?l.interactions.length:f;s.type=o,s.originalEvent=null,l.results=[];do if(p=l.interactions[m]){if(o!=="dragend"&&p.cancelled)continue;_=t.properties(s,l,p),p.results=[],n(d||p[h]||l.droppable).each(function(b,v){if(_.target=v,s.isPropagationStopped=function(){return!1},u=v?i.dispatch.call(v,s,_):null,u===!1?(h=="drag"&&(p.cancelled=!0,l.propagates-=1),o=="drop"&&(p[h][b]=null)):o=="dropinit"&&p.droppable.push(t.element(u)||v),o=="dragstart"&&(p.proxy=n(t.element(u)||p.drag)[0]),p.results.push(u),delete s.result,o!=="dropinit")return u}),l.results[m]=t.flatten(p.results),o=="dropinit"&&(p.droppable=t.flatten(p.droppable)),o=="dragstart"&&!p.cancelled&&_.update()}while(++m<y);return s.type=g.type,s.originalEvent=g.event,t.flatten(l.results)}},properties:function(s,o,l){var f=l.callback;return f.drag=l.drag,f.proxy=l.proxy||l.drag,f.startX=o.pageX,f.startY=o.pageY,f.deltaX=s.pageX-o.pageX,f.deltaY=s.pageY-o.pageY,f.originalX=l.offset.left,f.originalY=l.offset.top,f.offsetX=f.originalX+f.deltaX,f.offsetY=f.originalY+f.deltaY,f.drop=t.flatten((l.drop||[]).slice()),f.available=t.flatten((l.droppable||[]).slice()),f},element:function(s){if(s&&(s.jquery||s.nodeType==1))return s},flatten:function(s){return n.map(s,function(o){return o&&o.jquery?n.makeArray(o):o&&o.length?t.flatten(o):o})},textselect:function(s){n(document)[s?"unbind":"bind"]("selectstart",t.dontstart).css("MozUserSelect",s?"":"none"),document.unselectable=s?"off":"on"},dontstart:function(){return!1},callback:function(){}};t.callback.prototype={update:function(){e.drop&&this.available.length&&n.each(this.available,function(s){e.drop.locate(this,s)})}};var r=i.dispatch;i.dispatch=function(s){if(n.data(this,"suppress."+s.type)-new Date().getTime()>0){n.removeData(this,"suppress."+s.type);return}return r.apply(this,arguments)};var a=i.fixHooks.touchstart=i.fixHooks.touchmove=i.fixHooks.touchend=i.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(s,o){if(o){var l=o.touches&&o.touches[0]||o.changedTouches&&o.changedTouches[0]||null;l&&n.each(a.props,function(f,d){s[d]=l[d]})}return s}};e.draginit=e.dragstart=e.dragend=t})(jQuery);(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","jquery.ui.widget"],n):n(window.jQuery)})(function(n){"use strict";n.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||n('<input type="file">').prop("disabled")),n.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader),n.support.xhrFormDataFileUpload=!!window.FormData,n.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),n.widget("blueimp.fileupload",{options:{dropZone:n(document),pasteZone:n(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(i,e){return i=this.messages[i]||i.toString(),e&&n.each(e,function(t,r){i=i.replace("{"+t+"}",r)}),i},formData:function(i){return i.serializeArray()},add:function(i,e){if(i.isDefaultPrevented())return!1;(e.autoUpload||e.autoUpload!==!1&&n(this).fileupload("option","autoUpload"))&&e.process().done(function(){e.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:n.support.blobSlice&&function(){var i=this.slice||this.webkitSlice||this.mozSlice;return i.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():new Date().getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(i,e,t){var r=i-this.timestamp;return(!this.bitrate||!t||r>t)&&(this.bitrate=(e-this.loaded)*(1e3/r)*8,this.loaded=e,this.timestamp=i),this.bitrate}},_isXHRUpload:function(i){return!i.forceIframeTransport&&(!i.multipart&&n.support.xhrFileUpload||n.support.xhrFormDataFileUpload)},_getFormData:function(i){var e;return n.type(i.formData)==="function"?i.formData(i.form):n.isArray(i.formData)?i.formData:n.type(i.formData)==="object"?(e=[],n.each(i.formData,function(t,r){e.push({name:t,value:r})}),e):[]},_getTotal:function(i){var e=0;return n.each(i,function(t,r){e+=r.size||1}),e},_initProgressObject:function(i){var e={loaded:0,total:0,bitrate:0};i._progress?n.extend(i._progress,e):i._progress=e},_initResponseObject:function(i){var e;if(i._response)for(e in i._response)i._response.hasOwnProperty(e)&&delete i._response[e];else i._response={}},_onProgress:function(i,e){if(i.lengthComputable){var t=Date.now?Date.now():new Date().getTime(),r;if(e._time&&e.progressInterval&&t-e._time<e.progressInterval&&i.loaded!==i.total)return;e._time=t,r=Math.floor(i.loaded/i.total*(e.chunkSize||e._progress.total))+(e.uploadedBytes||0),this._progress.loaded+=r-e._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(t,this._progress.loaded,e.bitrateInterval),e._progress.loaded=e.loaded=r,e._progress.bitrate=e.bitrate=e._bitrateTimer.getBitrate(t,r,e.bitrateInterval),this._trigger("progress",n.Event("progress",{delegatedEvent:i}),e),this._trigger("progressall",n.Event("progressall",{delegatedEvent:i}),this._progress)}},_initProgressListener:function(i){var e=this,t=i.xhr?i.xhr():n.ajaxSettings.xhr();t.upload&&(n(t.upload).bind("progress",function(r){var a=r.originalEvent;r.lengthComputable=a.lengthComputable,r.loaded=a.loaded,r.total=a.total,e._onProgress(r,i)}),i.xhr=function(){return t})},_isInstanceOf:function(i,e){return Object.prototype.toString.call(e)==="[object "+i+"]"},_initXHRData:function(i){var e=this,t,r=i.files[0],a=i.multipart||!n.support.xhrFileUpload,s=n.type(i.paramName)==="array"?i.paramName[0]:i.paramName;i.headers=n.extend({},i.headers),i.contentRange&&(i.headers["Content-Range"]=i.contentRange),(!a||i.blob||!this._isInstanceOf("File",r))&&(i.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.name)+'"'),a?n.support.xhrFormDataFileUpload&&(i.postMessage?(t=this._getFormData(i),i.blob?t.push({name:s,value:i.blob}):n.each(i.files,function(o,l){t.push({name:n.type(i.paramName)==="array"&&i.paramName[o]||s,value:l})})):(e._isInstanceOf("FormData",i.formData)?t=i.formData:(t=new FormData,n.each(this._getFormData(i),function(o,l){t.append(l.name,l.value)})),i.blob?t.append(s,i.blob,r.name):n.each(i.files,function(o,l){(e._isInstanceOf("File",l)||e._isInstanceOf("Blob",l))&&t.append(n.type(i.paramName)==="array"&&i.paramName[o]||s,l,l.uploadName||l.name)})),i.data=t):(i.contentType=r.type||"application/octet-stream",i.data=i.blob||r),i.blob=null},_initIframeSettings:function(i){var e=n("<a></a>").prop("href",i.url).prop("host");i.dataType="iframe "+(i.dataType||""),i.formData=this._getFormData(i),i.redirect&&e&&e!==location.host&&i.formData.push({name:i.redirectParamName||"redirect",value:i.redirect})},_initDataSettings:function(i){this._isXHRUpload(i)?(this._chunkedUpload(i,!0)||(i.data||this._initXHRData(i),this._initProgressListener(i)),i.postMessage&&(i.dataType="postmessage "+(i.dataType||""))):this._initIframeSettings(i)},_getParamName:function(i){var e=n(i.fileInput),t=i.paramName;return t?n.isArray(t)||(t=[t]):(t=[],e.each(function(){for(var r=n(this),a=r.prop("name")||"files[]",s=(r.prop("files")||[1]).length;s;)t.push(a),s-=1}),t.length||(t=[e.prop("name")||"files[]"])),t},_initFormSettings:function(i){(!i.form||!i.form.length)&&(i.form=n(i.fileInput.prop("form")),i.form.length||(i.form=n(this.options.fileInput.prop("form")))),i.paramName=this._getParamName(i),i.url||(i.url=i.form.prop("action")||location.href),i.type=(i.type||n.type(i.form.prop("method"))==="string"&&i.form.prop("method")||"").toUpperCase(),i.type!=="POST"&&i.type!=="PUT"&&i.type!=="PATCH"&&(i.type="POST"),i.formAcceptCharset||(i.formAcceptCharset=i.form.attr("accept-charset"))},_getAJAXSettings:function(i){var e=n.extend({},this.options,i);return this._initFormSettings(e),this._initDataSettings(e),e},_getDeferredState:function(i){return i.state?i.state():i.isResolved()?"resolved":i.isRejected()?"rejected":"pending"},_enhancePromise:function(i){return i.success=i.done,i.error=i.fail,i.complete=i.always,i},_getXHRPromise:function(i,e,t){var r=n.Deferred(),a=r.promise();return e=e||this.options.context||a,i===!0?r.resolveWith(e,t):i===!1&&r.rejectWith(e,t),a.abort=r.promise,this._enhancePromise(a)},_addConvenienceMethods:function(i,e){var t=this,r=function(a){return n.Deferred().resolveWith(t,a).promise()};e.process=function(a,s){return(a||s)&&(e._processQueue=this._processQueue=(this._processQueue||r([this])).pipe(function(){return e.errorThrown?n.Deferred().rejectWith(t,[e]).promise():r(arguments)}).pipe(a,s)),this._processQueue||r([this])},e.submit=function(){return this.state()!=="pending"&&(e.jqXHR=this.jqXHR=t._trigger("submit",n.Event("submit",{delegatedEvent:i}),this)!==!1&&t._onSend(i,this)),this.jqXHR||t._getXHRPromise()},e.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",t._trigger("fail",null,this),t._getXHRPromise(!1))},e.state=function(){if(this.jqXHR)return t._getDeferredState(this.jqXHR);if(this._processQueue)return t._getDeferredState(this._processQueue)},e.processing=function(){return!this.jqXHR&&this._processQueue&&t._getDeferredState(this._processQueue)==="pending"},e.progress=function(){return this._progress},e.response=function(){return this._response}},_getUploadedBytes:function(i){var e=i.getResponseHeader("Range"),t=e&&e.split("-"),r=t&&t.length>1&&parseInt(t[1],10);return r&&r+1},_chunkedUpload:function(i,e){i.uploadedBytes=i.uploadedBytes||0;var t=this,r=i.files[0],a=r.size,s=i.uploadedBytes,o=i.maxChunkSize||a,l=this._blobSlice,f=n.Deferred(),d=f.promise(),g,h;return!(this._isXHRUpload(i)&&l&&(s||o<a))||i.data?!1:e?!0:s>=a?(r.error=i.i18n("uploadedBytes"),this._getXHRPromise(!1,i.context,[null,"error",r.error])):(h=function(){var u=n.extend({},i),m=u._progress.loaded;u.blob=l.call(r,s,s+o,r.type),u.chunkSize=u.blob.size,u.contentRange="bytes "+s+"-"+(s+u.chunkSize-1)+"/"+a,t._initXHRData(u),t._initProgressListener(u),g=(t._trigger("chunksend",null,u)!==!1&&n.ajax(u)||t._getXHRPromise(!1,u.context)).done(function(p,c,_){s=t._getUploadedBytes(_)||s+u.chunkSize,m+u.chunkSize-u._progress.loaded&&t._onProgress(n.Event("progress",{lengthComputable:!0,loaded:s-u.uploadedBytes,total:s-u.uploadedBytes}),u),i.uploadedBytes=u.uploadedBytes=s,u.result=p,u.textStatus=c,u.jqXHR=_,t._trigger("chunkdone",null,u),t._trigger("chunkalways",null,u),s<a?h():f.resolveWith(u.context,[p,c,_])}).fail(function(p,c,_){u.jqXHR=p,u.textStatus=c,u.errorThrown=_,t._trigger("chunkfail",null,u),t._trigger("chunkalways",null,u),f.rejectWith(u.context,[p,c,_])})},this._enhancePromise(d),d.abort=function(){return g.abort()},h(),d)},_beforeSend:function(i,e){this._active===0&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(e),this._initProgressObject(e),e._progress.loaded=e.loaded=e.uploadedBytes||0,e._progress.total=e.total=this._getTotal(e.files)||1,e._progress.bitrate=e.bitrate=0,this._active+=1,this._progress.loaded+=e.loaded,this._progress.total+=e.total},_onDone:function(i,e,t,r){var a=r._progress.total,s=r._response;r._progress.loaded<a&&this._onProgress(n.Event("progress",{lengthComputable:!0,loaded:a,total:a}),r),s.result=r.result=i,s.textStatus=r.textStatus=e,s.jqXHR=r.jqXHR=t,this._trigger("done",null,r)},_onFail:function(i,e,t,r){var a=r._response;r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total),a.jqXHR=r.jqXHR=i,a.textStatus=r.textStatus=e,a.errorThrown=r.errorThrown=t,this._trigger("fail",null,r)},_onAlways:function(i,e,t,r){this._trigger("always",null,r)},_onSend:function(i,e){e.submit||this._addConvenienceMethods(i,e);var t=this,r,a,s,o,l=t._getAJAXSettings(e),f=function(){return t._sending+=1,l._bitrateTimer=new t._BitrateTimer,r=r||((a||t._trigger("send",n.Event("send",{delegatedEvent:i}),l)===!1)&&t._getXHRPromise(!1,l.context,a)||t._chunkedUpload(l)||n.ajax(l)).done(function(d,g,h){t._onDone(d,g,h,l)}).fail(function(d,g,h){t._onFail(d,g,h,l)}).always(function(d,g,h){if(t._onAlways(d,g,h,l),t._sending-=1,t._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>t._sending)for(var u=t._slots.shift();u;){if(t._getDeferredState(u)==="pending"){u.resolve();break}u=t._slots.shift()}t._active===0&&t._trigger("stop")}),r};return this._beforeSend(i,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(s=n.Deferred(),this._slots.push(s),o=s.pipe(f)):(this._sequence=this._sequence.pipe(f,f),o=this._sequence),o.abort=function(){return a=[void 0,"abort","abort"],r?r.abort():(s&&s.rejectWith(l.context,a),f())},this._enhancePromise(o)):f()},_onAdd:function(i,e){var t=this,r=!0,a=n.extend({},this.options,e),s=e.files,o=s.length,l=a.limitMultiFileUploads,f=a.limitMultiFileUploadSize,d=a.limitMultiFileUploadSizeOverhead,g=0,h=this._getParamName(a),u,m,p,c,_=0;if(f&&(!o||s[0].size===void 0)&&(f=void 0),!(a.singleFileUploads||l||f)||!this._isXHRUpload(a))p=[s],u=[h];else if(!(a.singleFileUploads||f)&&l)for(p=[],u=[],c=0;c<o;c+=l)p.push(s.slice(c,c+l)),m=h.slice(c,c+l),m.length||(m=h),u.push(m);else if(!a.singleFileUploads&&f)for(p=[],u=[],c=0;c<o;c=c+1)g+=s[c].size+d,(c+1===o||g+s[c+1].size+d>f||l&&c+1-_>=l)&&(p.push(s.slice(_,c+1)),m=h.slice(_,c+1),m.length||(m=h),u.push(m),_=c+1,g=0);else u=h;return e.originalFiles=s,n.each(p||s,function(y,b){var v=n.extend({},e);return v.files=p?b:[b],v.paramName=u[y],t._initResponseObject(v),t._initProgressObject(v),t._addConvenienceMethods(i,v),r=t._trigger("add",n.Event("add",{delegatedEvent:i}),v),r}),r},_replaceFileInput:function(i){var e=i.clone(!0);n("<form></form>").append(e)[0].reset(),i.after(e).detach(),n.cleanData(i.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(t,r){return r===i[0]?e[0]:r}),i[0]===this.element[0]&&(this.element=e)},_handleFileTreeEntry:function(i,e){var t=this,r=n.Deferred(),a=function(o){o&&!o.entry&&(o.entry=i),r.resolve([o])},s;return e=e||"",i.isFile?i._file?(i._file.relativePath=e,r.resolve(i._file)):i.file(function(o){o.relativePath=e,r.resolve(o)},a):i.isDirectory?(s=i.createReader(),s.readEntries(function(o){t._handleFileTreeEntries(o,e+i.name+"/").done(function(l){r.resolve(l)}).fail(a)},a)):r.resolve([]),r.promise()},_handleFileTreeEntries:function(i,e){var t=this;return n.when.apply(n,n.map(i,function(r){return t._handleFileTreeEntry(r,e)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(i){i=i||{};var e=i.items;return e&&e.length&&(e[0].webkitGetAsEntry||e[0].getAsEntry)?this._handleFileTreeEntries(n.map(e,function(t){var r;return t.webkitGetAsEntry?(r=t.webkitGetAsEntry(),r&&(r._file=t.getAsFile()),r):t.getAsEntry()})):n.Deferred().resolve(n.makeArray(i.files)).promise()},_getSingleFileInputFiles:function(i){i=n(i);var e=i.prop("webkitEntries")||i.prop("entries"),t,r;if(e&&e.length)return this._handleFileTreeEntries(e);if(t=n.makeArray(i.prop("files")),t.length)t[0].name===void 0&&t[0].fileName&&n.each(t,function(a,s){s.name=s.fileName,s.size=s.fileSize});else{if(r=i.prop("value"),!r)return n.Deferred().resolve([]).promise();t=[{name:r.replace(/^.*\\/,"")}]}return n.Deferred().resolve(t).promise()},_getFileInputFiles:function(i){return!(i instanceof n)||i.length===1?this._getSingleFileInputFiles(i):n.when.apply(n,n.map(i,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(i){var e=this,t={fileInput:n(i.target),form:n(i.target.form)};this._getFileInputFiles(t.fileInput).always(function(r){t.files=r,e.options.replaceFileInput&&e._replaceFileInput(t.fileInput),e._trigger("change",n.Event("change",{delegatedEvent:i}),t)!==!1&&e._onAdd(i,t)})},_onPaste:function(i){var e=i.originalEvent&&i.originalEvent.clipboardData&&i.originalEvent.clipboardData.items,t={files:[]};e&&e.length&&(n.each(e,function(r,a){var s=a.getAsFile&&a.getAsFile();s&&t.files.push(s)}),this._trigger("paste",n.Event("paste",{delegatedEvent:i}),t)!==!1&&this._onAdd(i,t))},_onDrop:function(i){i.dataTransfer=i.originalEvent&&i.originalEvent.dataTransfer;var e=this,t=i.dataTransfer,r={};t&&t.files&&t.files.length&&(i.preventDefault(),this._getDroppedFiles(t).always(function(a){r.files=a,e._trigger("drop",n.Event("drop",{delegatedEvent:i}),r)!==!1&&e._onAdd(i,r)}))},_onDragOver:function(i){i.dataTransfer=i.originalEvent&&i.originalEvent.dataTransfer;var e=i.dataTransfer;e&&n.inArray("Files",e.types)!==-1&&this._trigger("dragover",n.Event("dragover",{delegatedEvent:i}))!==!1&&(i.preventDefault(),e.dropEffect="copy")},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),n.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(i,e){var t=n.inArray(i,this._specialOptions)!==-1;t&&this._destroyEventHandlers(),this._super(i,e),t&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var i=this.options;i.fileInput===void 0?i.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):i.fileInput instanceof n||(i.fileInput=n(i.fileInput)),i.dropZone instanceof n||(i.dropZone=n(i.dropZone)),i.pasteZone instanceof n||(i.pasteZone=n(i.pasteZone))},_getRegExp:function(i){var e=i.split("/"),t=e.pop();return e.shift(),new RegExp(e.join("/"),t)},_isRegExpOption:function(i,e){return i!=="url"&&n.type(e)==="string"&&/^\/.*\/[igm]{0,3}$/.test(e)},_initDataAttributes:function(){var i=this,e=this.options,t=n(this.element[0].cloneNode(!1));n.each(t.data(),function(r,a){var s="data-"+r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();t.attr(s)&&(i._isRegExpOption(r,a)&&(a=i._getRegExp(a)),e[r]=a)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(i){var e=this;!i||this.options.disabled||(i.fileInput&&!i.files?this._getFileInputFiles(i.fileInput).always(function(t){i.files=t,e._onAdd(null,i)}):(i.files=n.makeArray(i.files),this._onAdd(null,i)))},send:function(i){if(i&&!this.options.disabled){if(i.fileInput&&!i.files){var e=this,t=n.Deferred(),r=t.promise(),a,s;return r.abort=function(){return s=!0,a?a.abort():(t.reject(null,"abort","abort"),r)},this._getFileInputFiles(i.fileInput).always(function(o){if(!s){if(!o.length){t.reject();return}i.files=o,a=e._onSend(null,i).then(function(l,f,d){t.resolve(l,f,d)},function(l,f,d){t.reject(l,f,d)})}}),this._enhancePromise(r)}if(i.files=n.makeArray(i.files),i.files.length)return this._onSend(null,i)}return this._getXHRPromise(!1,i&&i.context)}})});(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","tmpl","./jquery.fileupload-image","./jquery.fileupload-audio","./jquery.fileupload-video","./jquery.fileupload-validate"],n):n(window.jQuery,window.tmpl)})(function(n,i){"use strict";n.blueimp.fileupload.prototype._specialOptions.push("filesContainer","uploadTemplateId","downloadTemplateId"),n.widget("blueimp.fileupload",n.blueimp.fileupload,{options:{autoUpload:!1,uploadTemplateId:"template-upload",downloadTemplateId:"template-download",filesContainer:void 0,prependFiles:!1,dataType:"json",getNumberOfFiles:function(){return this.filesContainer.children().not(".processing").length},getFilesFromResponse:function(e){return e.result&&n.isArray(e.result.files)?e.result.files:[]},add:function(e,t){if(e.isDefaultPrevented())return!1;var r=n(this),a=r.data("blueimp-fileupload")||r.data("fileupload"),s=a.options;t.context=a._renderUpload(t.files).data("data",t).addClass("processing"),s.filesContainer[s.prependFiles?"prepend":"append"](t.context),a._forceReflow(t.context),a._transition(t.context),t.process(function(){return r.fileupload("process",t)}).always(function(){t.context.each(function(o){n(this).find(".size").text(a._formatFileSize(t.files[o].size))}).removeClass("processing"),a._renderPreviews(t)}).done(function(){t.context.find(".start").prop("disabled",!1),a._trigger("added",e,t)!==!1&&(s.autoUpload||t.autoUpload)&&t.autoUpload!==!1&&t.submit()}).fail(function(){t.files.error&&t.context.each(function(o){var l=t.files[o].error;l&&n(this).find(".error").text(l)})})},send:function(e,t){if(e.isDefaultPrevented())return!1;var r=n(this).data("blueimp-fileupload")||n(this).data("fileupload");return t.context&&t.dataType&&t.dataType.substr(0,6)==="iframe"&&t.context.find(".progress").addClass(!n.support.transition&&"progress-animated").attr("aria-valuenow",100).children().first().css("width","100%"),r._trigger("sent",e,t)},done:function(e,t){if(e.isDefaultPrevented())return!1;var r=n(this).data("blueimp-fileupload")||n(this).data("fileupload"),a=t.getFilesFromResponse||r.options.getFilesFromResponse,s=a(t),o,l;t.context?t.context.each(function(f){var d=s[f]||{error:"Empty file upload result"};l=r._addFinishedDeferreds(),r._transition(n(this)).done(function(){var g=n(this);o=r._renderDownload([d]).replaceAll(g),r._forceReflow(o),r._transition(o).done(function(){t.context=n(this),r._trigger("completed",e,t),r._trigger("finished",e,t),l.resolve()})})}):(o=r._renderDownload(s)[r.options.prependFiles?"prependTo":"appendTo"](r.options.filesContainer),r._forceReflow(o),l=r._addFinishedDeferreds(),r._transition(o).done(function(){t.context=n(this),r._trigger("completed",e,t),r._trigger("finished",e,t),l.resolve()}))},fail:function(e,t){if(e.isDefaultPrevented())return!1;var r=n(this).data("blueimp-fileupload")||n(this).data("fileupload"),a,s;t.context?t.context.each(function(o){if(t.errorThrown!=="abort"){var l=t.files[o];l.error=l.error||t.errorThrown||!0,s=r._addFinishedDeferreds(),r._transition(n(this)).done(function(){var f=n(this);a=r._renderDownload([l]).replaceAll(f),r._forceReflow(a),r._transition(a).done(function(){t.context=n(this),r._trigger("failed",e,t),r._trigger("finished",e,t),s.resolve()})})}else s=r._addFinishedDeferreds(),r._transition(n(this)).done(function(){n(this).remove(),r._trigger("failed",e,t),r._trigger("finished",e,t),s.resolve()})}):t.errorThrown!=="abort"?(t.context=r._renderUpload(t.files)[r.options.prependFiles?"prependTo":"appendTo"](r.options.filesContainer).data("data",t),r._forceReflow(t.context),s=r._addFinishedDeferreds(),r._transition(t.context).done(function(){t.context=n(this),r._trigger("failed",e,t),r._trigger("finished",e,t),s.resolve()})):(r._trigger("failed",e,t),r._trigger("finished",e,t),r._addFinishedDeferreds().resolve())},progress:function(e,t){if(e.isDefaultPrevented())return!1;var r=Math.floor(t.loaded/t.total*100);t.context&&t.context.each(function(){n(this).find(".progress").attr("aria-valuenow",r).children().first().css("width",r+"%")})},progressall:function(e,t){if(e.isDefaultPrevented())return!1;var r=n(this),a=Math.floor(t.loaded/t.total*100),s=r.find(".fileupload-progress"),o=s.find(".progress-extended");o.length&&o.html((r.data("blueimp-fileupload")||r.data("fileupload"))._renderExtendedProgress(t)),s.find(".progress").attr("aria-valuenow",a).children().first().css("width",a+"%")},start:function(e){if(e.isDefaultPrevented())return!1;var t=n(this).data("blueimp-fileupload")||n(this).data("fileupload");t._resetFinishedDeferreds(),t._transition(n(this).find(".fileupload-progress")).done(function(){t._trigger("started",e)})},stop:function(e){if(e.isDefaultPrevented())return!1;var t=n(this).data("blueimp-fileupload")||n(this).data("fileupload"),r=t._addFinishedDeferreds();n.when.apply(n,t._getFinishedDeferreds()).done(function(){t._trigger("stopped",e)}),t._transition(n(this).find(".fileupload-progress")).done(function(){n(this).find(".progress").attr("aria-valuenow","0").children().first().css("width","0%"),n(this).find(".progress-extended").html("&nbsp;"),r.resolve()})},processstart:function(e){if(e.isDefaultPrevented())return!1;n(this).addClass("fileupload-processing")},processstop:function(e){if(e.isDefaultPrevented())return!1;n(this).removeClass("fileupload-processing")},destroy:function(e,t){if(e.isDefaultPrevented())return!1;var r=n(this).data("blueimp-fileupload")||n(this).data("fileupload"),a=function(){r._transition(t.context).done(function(){n(this).remove(),r._trigger("destroyed",e,t)})};t.url?(t.dataType=t.dataType||r.options.dataType,n.ajax(t).done(a).fail(function(){r._trigger("destroyfailed",e,t)})):a()}},_resetFinishedDeferreds:function(){this._finishedUploads=[]},_addFinishedDeferreds:function(e){return e||(e=n.Deferred()),this._finishedUploads.push(e),e},_getFinishedDeferreds:function(){return this._finishedUploads},_enableDragToDesktop:function(){var e=n(this),t=e.prop("href"),r=e.prop("download"),a="application/octet-stream";e.bind("dragstart",function(s){try{s.originalEvent.dataTransfer.setData("DownloadURL",[a,r,t].join(":"))}catch{}})},_formatFileSize:function(e){return typeof e!="number"?"":e>=1e9?(e/1e9).toFixed(2)+" GB":e>=1e6?(e/1e6).toFixed(2)+" MB":(e/1e3).toFixed(2)+" KB"},_formatBitrate:function(e){return typeof e!="number"?"":e>=1e9?(e/1e9).toFixed(2)+" Gbit/s":e>=1e6?(e/1e6).toFixed(2)+" Mbit/s":e>=1e3?(e/1e3).toFixed(2)+" kbit/s":e.toFixed(2)+" bit/s"},_formatTime:function(e){var t=new Date(e*1e3),r=Math.floor(e/86400);return r=r?r+"d ":"",r+("0"+t.getUTCHours()).slice(-2)+":"+("0"+t.getUTCMinutes()).slice(-2)+":"+("0"+t.getUTCSeconds()).slice(-2)},_formatPercentage:function(e){return(e*100).toFixed(2)+" %"},_renderExtendedProgress:function(e){return this._formatBitrate(e.bitrate)+" | "+this._formatTime((e.total-e.loaded)*8/e.bitrate)+" | "+this._formatPercentage(e.loaded/e.total)+" | "+this._formatFileSize(e.loaded)+" / "+this._formatFileSize(e.total)},_renderTemplate:function(e,t){if(!e)return n();var r=e({files:t,formatFileSize:this._formatFileSize,options:this.options});return r instanceof n?r:n(this.options.templatesContainer).html(r).children()},_renderPreviews:function(e){e.context.find(".preview").each(function(t,r){n(r).append(e.files[t].preview)})},_renderUpload:function(e){return this._renderTemplate(this.options.uploadTemplate,e)},_renderDownload:function(e){return this._renderTemplate(this.options.downloadTemplate,e).find("a[download]").each(this._enableDragToDesktop).end()},_startHandler:function(e){e.preventDefault();var t=n(e.currentTarget),r=t.closest(".template-upload"),a=r.data("data");t.prop("disabled",!0),a&&a.submit&&a.submit()},_cancelHandler:function(e){e.preventDefault();var t=n(e.currentTarget).closest(".template-upload,.template-download"),r=t.data("data")||{};r.context=r.context||t,r.abort?r.abort():(r.errorThrown="abort",this._trigger("fail",e,r))},_deleteHandler:function(e){e.preventDefault();var t=n(e.currentTarget);this._trigger("destroy",e,n.extend({context:t.closest(".template-download"),type:"DELETE"},t.data()))},_forceReflow:function(e){return n.support.transition&&e.length&&e[0].offsetWidth},_transition:function(e){var t=n.Deferred();return n.support.transition&&e.hasClass("fade")&&e.is(":visible")?e.bind(n.support.transition.end,function(r){r.target===e[0]&&(e.unbind(n.support.transition.end),t.resolveWith(e))}).toggleClass("in"):(e.toggleClass("in"),t.resolveWith(e)),t},_initButtonBarEventHandlers:function(){var e=this.element.find(".fileupload-buttonbar"),t=this.options.filesContainer;this._on(e.find(".start"),{click:function(r){r.preventDefault(),t.find(".start").click()}}),this._on(e.find(".cancel"),{click:function(r){r.preventDefault(),t.find(".cancel").click()}}),this._on(e.find(".delete"),{click:function(r){r.preventDefault(),t.find(".toggle:checked").closest(".template-download").find(".delete").click(),e.find(".toggle").prop("checked",!1)}}),this._on(e.find(".toggle"),{change:function(r){t.find(".toggle").prop("checked",n(r.currentTarget).is(":checked"))}})},_destroyButtonBarEventHandlers:function(){this._off(this.element.find(".fileupload-buttonbar").find(".start, .cancel, .delete"),"click"),this._off(this.element.find(".fileupload-buttonbar .toggle"),"change.")},_initEventHandlers:function(){this._super(),this._on(this.options.filesContainer,{"click .start":this._startHandler,"click .cancel":this._cancelHandler,"click .delete":this._deleteHandler}),this._initButtonBarEventHandlers()},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers(),this._off(this.options.filesContainer,"click"),this._super()},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!1).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!0).parent().addClass("disabled")},_initTemplates:function(){var e=this.options;e.templatesContainer=this.document[0].createElement(e.filesContainer.prop("nodeName")),i&&(e.uploadTemplateId&&(e.uploadTemplate=i(e.uploadTemplateId)),e.downloadTemplateId&&(e.downloadTemplate=i(e.downloadTemplateId)))},_initFilesContainer:function(){var e=this.options;e.filesContainer===void 0?e.filesContainer=this.element.find(".files"):e.filesContainer instanceof n||(e.filesContainer=n(e.filesContainer))},_initSpecialOptions:function(){this._super(),this._initFilesContainer(),this._initTemplates()},_create:function(){this._super(),this._resetFinishedDeferreds(),n.support.fileInput||this._disableFileInputButton()},enable:function(){var e=!1;this.options.disabled&&(e=!0),this._super(),e&&(this.element.find("input, button").prop("disabled",!1),this._enableFileInputButton())},disable:function(){this.options.disabled||(this.element.find("input, button").prop("disabled",!0),this._disableFileInputButton()),this._super()}})});(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","./jquery.fileupload"],n):n(window.jQuery)})(function(n){"use strict";var i=n.blueimp.fileupload.prototype.options.add;n.widget("blueimp.fileupload",n.blueimp.fileupload,{options:{processQueue:[],add:function(e,t){var r=n(this);t.process(function(){return r.fileupload("process",t)}),i.call(this,e,t)}},processActions:{},_processFile:function(e,t){var r=this,a=n.Deferred().resolveWith(r,[e]),s=a.promise();return this._trigger("process",null,e),n.each(e.processQueue,function(o,l){var f=function(d){return t.errorThrown?n.Deferred().rejectWith(r,[t]).promise():r.processActions[l.action].call(r,d,l)};s=s.pipe(f,l.always&&f)}),s.done(function(){r._trigger("processdone",null,e),r._trigger("processalways",null,e)}).fail(function(){r._trigger("processfail",null,e),r._trigger("processalways",null,e)}),s},_transformProcessQueue:function(e){var t=[];n.each(e.processQueue,function(){var r={},a=this.action,s=this.prefix===!0?a:this.prefix;n.each(this,function(o,l){n.type(l)==="string"&&l.charAt(0)==="@"?r[o]=e[l.slice(1)||(s?s+o.charAt(0).toUpperCase()+o.slice(1):o)]:r[o]=l}),t.push(r)}),e.processQueue=t},processing:function(){return this._processing},process:function(e){var t=this,r=n.extend({},this.options,e);return r.processQueue&&r.processQueue.length&&(this._transformProcessQueue(r),this._processing===0&&this._trigger("processstart"),n.each(e.files,function(a){var s=a?n.extend({},r):r,o=function(){return e.errorThrown?n.Deferred().rejectWith(t,[e]).promise():t._processFile(s,e)};s.index=a,t._processing+=1,t._processingQueue=t._processingQueue.pipe(o,o).always(function(){t._processing-=1,t._processing===0&&t._trigger("processstop")})})),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=n.Deferred().resolveWith(this).promise()}})});})();
/*! 
 * jquery.event.drag - v 2.2
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */
